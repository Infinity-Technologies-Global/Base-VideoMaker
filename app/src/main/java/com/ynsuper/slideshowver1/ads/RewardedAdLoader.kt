package com.ynsuper.slideshowver1.adsimport android.app.Activityimport android.content.Contextimport android.graphics.Colorimport android.util.Logimport android.view.Gravityimport android.view.ViewGroupimport android.view.WindowManagerimport android.widget.LinearLayoutimport android.widget.ProgressBarimport android.widget.TextViewimport androidx.annotation.NonNullimport androidx.appcompat.app.AlertDialogimport com.google.android.gms.ads.AdRequestimport com.google.android.gms.ads.rewarded.RewardItemimport com.google.android.gms.ads.rewarded.RewardedAdimport com.google.android.gms.ads.rewarded.RewardedAdCallbackimport com.google.android.gms.ads.rewarded.RewardedAdLoadCallbackimport com.ynsuper.slideshowver1.Rclass RewardedAdLoader {    private var mEventRewardedAdCallback: EventRewardedAdCallback? = null    lateinit var mContext: Context    var googleId: String? = ""    lateinit var rewardedAd: RewardedAd    var dialogError: AlertDialog? = null    var dialogLoading: AlertDialog? = null    private val adLoadCallback = object : RewardedAdLoadCallback() {        override fun onRewardedAdLoaded() {            showRewardedAd()        }        override fun onRewardedAdFailedToLoad(errorCode: Int) {            Log.d("Ynsuper","onRewardedAdFailedToLoad: $errorCode")            dialogLoading?.dismiss()            dialogError?.show()        }    }    private val adCallback = object : RewardedAdCallback() {        override fun onRewardedAdOpened() {            mEventRewardedAdCallback?.onAdClosed()        }        override fun onRewardedAdClosed() {            mEventRewardedAdCallback?.onAdClosed()        }        override fun onUserEarnedReward(@NonNull reward: RewardItem) {            mEventRewardedAdCallback?.onUserEarnedReward(reward)        }        override fun onRewardedAdFailedToShow(errorCode: Int) {            Log.d("Ynsuper","onRewardedAdFailedToShow: $errorCode")            mEventRewardedAdCallback?.onAdClosed()        }    }    fun setAdsId(context: Context, googleAdsId: String) {        mContext = context        googleId = googleAdsId        rewardedAd = RewardedAd(context, googleAdsId)        dialogError = AlertDialog.Builder(context)                .setTitle(context.getString(R.string.the_ad_is_not_available))                .setMessage(context.getString(R.string.unavailable_ads_you_can_try_again))                .setPositiveButton(                        android.R.string.ok                ) { dialog, which ->                    dialog.dismiss()                }                .create()        dialogLoading = buildProgressDialog(mContext, "Loading...")    }    private fun buildProgressDialog(context: Context, message: String): AlertDialog {        val padding = 50        val linearLayout = LinearLayout(context)        linearLayout.orientation = LinearLayout.HORIZONTAL        linearLayout.setPadding(padding, padding, padding, padding)        linearLayout.gravity = Gravity.START        var params = LinearLayout.LayoutParams(                LinearLayout.LayoutParams.WRAP_CONTENT,                LinearLayout.LayoutParams.WRAP_CONTENT        )        params.gravity = Gravity.CENTER        linearLayout.layoutParams = params        val progressBar = ProgressBar(context)        progressBar.isIndeterminate = true        progressBar.setPadding(0, 0, padding, 0)        progressBar.layoutParams = params        params = LinearLayout.LayoutParams(                ViewGroup.LayoutParams.WRAP_CONTENT,                ViewGroup.LayoutParams.WRAP_CONTENT        )        params.gravity = Gravity.CENTER        val tvText = TextView(context)        tvText.text = message        tvText.setTextColor(Color.parseColor("#000000"))        tvText.textSize = 20.toFloat()        tvText.layoutParams = params        linearLayout.addView(progressBar)        linearLayout.addView(tvText)        val builder = AlertDialog.Builder(context)        builder.setCancelable(false)        builder.setView(linearLayout)        val dialog = builder.create()        val window = dialog.window        if (window != null) {            val layoutParams = WindowManager.LayoutParams()            layoutParams.copyFrom(dialog.window?.attributes)            layoutParams.width = LinearLayout.LayoutParams.WRAP_CONTENT            layoutParams.height = LinearLayout.LayoutParams.WRAP_CONTENT            dialog.window?.attributes = layoutParams        }        return dialog    }    fun loadRewardedAd(eventRewardedAdCallback: EventRewardedAdCallback) {        mEventRewardedAdCallback = eventRewardedAdCallback        dialogLoading?.show()        rewardedAd.loadAd(AdRequest.Builder().build(), adLoadCallback)    }    fun showRewardedAd() {        dialogLoading?.dismiss()        when {            rewardedAd.isLoaded -> {                rewardedAd.show(mContext as Activity?, adCallback)            }            else -> {                dialogError?.show()            }        }    }    interface EventRewardedAdCallback {        fun onAdClosed()        fun onUserEarnedReward(reward: RewardItem)    }}