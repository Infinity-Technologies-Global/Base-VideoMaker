package com.ynsuper.slideshowver1.adsimport android.content.Contextimport android.content.Context.WINDOW_SERVICEimport android.content.pm.PackageManagerimport android.text.TextUtilsimport android.util.DisplayMetricsimport android.view.LayoutInflaterimport android.view.Viewimport android.view.WindowManagerimport android.widget.Buttonimport android.widget.ImageViewimport android.widget.RatingBarimport android.widget.TextViewimport com.google.android.gms.ads.AdSizeimport com.google.android.gms.ads.formats.UnifiedNativeAdimport com.google.android.gms.ads.formats.UnifiedNativeAdViewimport com.ynsuper.slideshowver1.Rimport kotlinx.android.synthetic.main.admob_native_ads.view.*object UtilAd {    fun googleAdaptiveBannerAdSize(context: Context, width: Float): AdSize {        val display = (context.getSystemService(WINDOW_SERVICE) as WindowManager).defaultDisplay        val outMetrics = DisplayMetrics()        display.getMetrics(outMetrics)        val density = outMetrics.density        var adWidthPixels = width        if (adWidthPixels == 0f) {            adWidthPixels = outMetrics.widthPixels.toFloat()        }        val adWidth = (adWidthPixels / density).toInt()        return AdSize.getCurrentOrientationAnchoredAdaptiveBannerAdSize(context, adWidth)    }    fun checkShowFacebookAds(context: Context): Boolean {        return try {            isFacebookAppInstalled(context) && verifyInstallerIdSourceGooglePlay(context)        } catch (e: Exception) {            false        }    }    fun isFacebookAppInstalled(context: Context): Boolean {        return try {            context.packageManager.getApplicationInfo(packageNameFacebookApp, 0)            true        } catch (e: PackageManager.NameNotFoundException) {            false        }    }    fun verifyInstallerIdSourceGooglePlay(context: Context): Boolean { // A list with valid installers package name        // The package name of the app that has installed your app        val installer =                context.packageManager.getInstallerPackageName(context.packageName)        // true if your app has been downloaded from Play Store        return installer != null && validInstallersByGooglePlay.contains(installer)    }    /**     *     *     * @param context     * @param nativeAd     * @return     */    fun buildViewNativeGoogleMedium2(context: Context, nativeAd: UnifiedNativeAd): View? {        val layoutInflater: LayoutInflater = LayoutInflater.from(context)        val adViewNativeGoogle = layoutInflater.inflate(                R.layout.admob_native_ads, null        )        val adView: UnifiedNativeAdView = adViewNativeGoogle.native_ad_view//            // Set the media view.        adView.mediaView = adView.media_view////            // Set other ad assets.        adView.headlineView = adViewNativeGoogle.primary        adView.bodyView = adViewNativeGoogle.body        adView.callToActionView = adViewNativeGoogle.cta        adView.iconView = adViewNativeGoogle.icon        adView.starRatingView = adViewNativeGoogle.rating_bar//            adView.priceView = adView.findViewById(R.id.ad_price)//            adView.storeView = adView.findViewById(R.id.ad_store)        adView.advertiserView = adViewNativeGoogle.ad_advertiser        if (adHasOnlyStore(nativeAd)) {            adView.storeView = adViewNativeGoogle.secondary            adViewNativeGoogle.secondary.text = nativeAd.store        } else if (!TextUtils.isEmpty(nativeAd.advertiser)) {            adView.advertiserView = adViewNativeGoogle.ad_advertiser            adViewNativeGoogle.ad_advertiser.text = nativeAd.advertiser        } else {            adViewNativeGoogle.ad_advertiser.text = ""        }        // The headline and media content are guaranteed to be in every UnifiednativeAd?.        (adView.headlineView as TextView).text = nativeAd.headline        adView.mediaView.setMediaContent(nativeAd.mediaContent)        // These assets aren't guaranteed to be in every UnifiedNativeAd, so it's important to        // check before trying to display them.        if (nativeAd.body == null) {            adView.bodyView.visibility = View.INVISIBLE        } else {            adView.bodyView.visibility = View.VISIBLE            (adView.bodyView as TextView).text = nativeAd.body        }        if (nativeAd.callToAction == null) {            adView.callToActionView.visibility = View.INVISIBLE        } else {            adView.callToActionView.visibility = View.VISIBLE            (adView.callToActionView as Button).text = nativeAd.callToAction        }        if (nativeAd.icon == null) {            adView.iconView.visibility = View.GONE        } else {            (adView.iconView as ImageView).setImageDrawable(                    nativeAd.icon.drawable            )            adView.iconView.visibility = View.VISIBLE        }        if (nativeAd.starRating == null) {            adView.starRatingView.visibility = View.INVISIBLE        } else {            (adView.starRatingView as RatingBar).rating = nativeAd.starRating!!.toFloat()            adView.starRatingView.visibility = View.VISIBLE        }        if (nativeAd.advertiser == null) {            adView.advertiserView.visibility = View.INVISIBLE        } else {            (adView.advertiserView as TextView).text = nativeAd.advertiser            adView.advertiserView.visibility = View.VISIBLE        }        adView.setNativeAd(nativeAd)        return adViewNativeGoogle    }    private fun adHasOnlyStore(nativeAd: UnifiedNativeAd): Boolean {        val store = nativeAd.store        val advertiser = nativeAd.advertiser        return !TextUtils.isEmpty(store) && TextUtils.isEmpty(advertiser)    }    val validInstallersByGooglePlay: MutableList<String> =            mutableListOf("com.android.vending", "com.google.android.feedback")    private const val packageNameFacebookApp: String = "com.facebook.katana"}